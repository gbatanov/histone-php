<?xml version="1.0" encoding="UTF-8"?>
<suites>

	<suite name="functions">
        <case>
            <input>{{foo()[1]}}</input>
            <expected type="json">[[105,[[106,null,"foo",null],[101,1]]]]</expected>
        </case>

		<case>
			<input>{{dayOfWeek(2012, 4, 2)}}</input>
			<expected type="json">[[106, null, "dayOfWeek", [
				[101, 2012],
				[101, 4],
				[101, 2]
				]]]
			</expected>
		</case>
		<case>
			<input>{{"string"()}}</input>
			<exception>
				<line>1</line>
				<expected>}}</expected>
				<found>(</found>
			</exception>
		</case>
        <case>
            <input>a {{macro name}} b {{/macro}} c</input>
            <expected type="json">["a ",[1003,"name",[],[" b "]]," c"]</expected>
        </case>

		<case>
            <input>a {{macro</input>
            <exception>
                <line>1</line>
                <expected>identifier</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{macro name</input>
            <exception>
                <line>1</line>
                <expected>}}</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{macro name(</input>
            <exception>
                <line>1</line>
                <expected>identifier</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{macro name(aa</input>
            <exception>
                <line>1</line>
                <expected>)</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{macro name(aa,</input>
            <exception>
                <line>1</line>
                <expected>identifier</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{macro name(aa,)</input>
            <exception>
                <line>1</line>
                <expected>identifier</expected>
                <found>)</found>
            </exception>
        </case>

        <case>
            <input>a {{macro name()}} b {{/macro}} c</input>
            <expected type="json">["a ",[1003,"name",[],[" b "]]," c"]</expected>
        </case>

        <case>
            <input>a {{macro name(arg1, arg2, arg3)}} b {{/macro}} c</input>
            <expected type="json">["a ",[1003,"name",["arg1","arg2","arg3"],[" b "]]," c"]</expected>
        </case>

        <case>
            <input>a {{macro name(a,b,c)</input>
            <exception>
                <line>1</line>
                <expected>}}</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{macro name(a,b,c)}} bbb</input>
            <exception>
                <line>1</line>
                <expected>{{/macro}}</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{call name}} b {{/call}} c</input>
            <expected type="json">["a ",[106,null,"name",[[109,[" b "]]]]," c"]</expected>
        </case>

        <case>
            <input>a {{call</input>
            <exception>
                <line>1</line>
                <expected>identifier</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{call name</input>
            <exception>
                <line>1</line>
                <expected>}}</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{call name(</input>
            <exception>
                <line>1</line>
                <expected>expression</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{call name(10*2</input>
            <exception>
                <line>1</line>
                <expected>)</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{call name('string',</input>
            <exception>
                <line>1</line>
                <expected>expression</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{call name('string', bar)</input>
            <exception>
                <line>1</line>
                <expected>}}</expected>
                <found>EOF</found>
            </exception>
        </case>

        <case>
            <input>a {{call name()}} b {{/call}} c</input>
            <expected type="json">["a ",[106,null,"name",[[109,[" b "]]]]," c"]</expected>
        </case>

        <case>
            <input>a {{call name(argA, argB, argC)}} b {{/call}} c</input>
            <expected type="json">["a ",[106,null,"name",[[105,["argA"]],[105,["argB"]],[105,["argC"]],[109,[" b "]]]]," c"]
            </expected>
        </case>

        <case>
            <input>a {{call name('string', bar)}}</input>
            <exception>
                <line>1</line>
                <expected>{{/call}}</expected>
                <found>EOF</found>
            </exception>
        </case>
        <case>
            <input>{{foo(3.14E+3}}</input>
            <exception>
                <line>1</line>
                <expected>)</expected>
                <found>}}</found>
            </exception>
        </case>

        <case>
            <input>{{true.foo(11)}}</input>
            <expected type="json">[[106,[105,[[16]]],"foo",[[101,11]]]]</expected>
        </case>

        <case>
            <input>{{false.foo(11)}}</input>
            <expected type="json">[[106,[105,[[17]]],"foo",[[101,11]]]]</expected>
        </case>

        <case>
            <input>{{null.foo()}}</input>
            <expected type="json">[
                [106, [105, [[100]]], "foo", null]
                ]
            </expected>
        </case>

        <case>
            <input>{{this.foo()}}</input>
            <expected type="json">[[106,[105,["this"]],"foo",null]]</expected>
        </case>

        <case>
            <input>{{self.foo()}}</input>
            <expected type="json">[[106,[105,["self"]],"foo",null]]</expected>
        </case>

        <case>
            <input>{{test.foo(}}</input>
            <exception>
                <line>1</line>
                <expected>expression</expected>
                <found>}}</found>
            </exception>
        </case>

        <case>
            <input>{{'string'.foo()}}</input>
            <expected type="json">[
                [106, [105, [[103, "string"]]], "foo", null]
                ]
            </expected>
        </case>

        <case>
            <input>{{111.foo(11}}</input>
            <exception>
                <line>1</line>
                <expected>)</expected>
                <found>}}</found>
            </exception>
        </case>

        <case>
            <input>{{12.foo()}}</input>
            <expected type="json">[
                [106, [105, [[101, 12]]], "foo", null]
                ]
            </expected>
        </case>

        <case>
            <input>{{17.62.foo()}}</input>
            <expected type="json">[
                [106, [105, [[102, 17.62]]], "foo", null]
                ]
            </expected>
        </case>

        <case>
            <input>{{17..62.foo()}}</input>
            <exception>
                <line>1</line>
                <expected>identifier</expected>
                <found>.62</found>
            </exception>
        </case>

        <case>
            <input>{{test()}}</input>
            <expected type="json">[[106,
                null,
                "test",
                null
                ]]
            </expected>
        </case>

        <case>
			<input>{{17(#}}</input>
			<exception>
				<line>1</line>
				<expected>}}</expected>
				<found>(</found>
			</exception>
		</case>

		<case>
			<input>{{test(1, 'string', 7.14)}}</input>
			<expected type="json">[[106, null, "test", [
				[101, 1],
				[103, "string"],
				[102, 7.14]
				]]]
			</expected>
		</case>

		<case>
			<input>{{foo.test()}}</input>
			<expected type="json">[[106,
				[105, ["foo"]],
				"test",
				null
				]]
			</expected>
		</case>

		<case>
			<input>{{foo.test("hey", "ho")}}</input>
			<expected type="json">[[106,
				[105, ["foo"]],
				"test", [
				[103, "hey"],
				[103, "ho"]
				]
				]]
			</expected>
		</case>

		<case>
			<input>{{foo['test']("hey", "ho")}}</input>
			<expected type="json">[[106,
				[105, ["foo"]],
				[103,"test"], [
				[103, "hey"],
				[103, "ho"]
				]
				]]
			</expected>
		</case>

		<case>
			<input>{{foo("hey", "ho").isNumber()}}</input>
			<expected type="json">[[106,
				[105,
				[[106,null,"foo",[
				[103,"hey"],
				[103,"ho"]
				]
				]]],
				"isNumber",null
				]]
			</expected>
		</case>

		<case>
			<input>{{foo(14)(1, 2, 3)}}</input>
			<exception>
				<line>1</line>
				<expected>}}</expected>
				<found>(</found>
			</exception>
		</case>

		<case>
			<input>{{foo(14)(1, 2, 3).do}}</input>
			<exception>
				<line>1</line>
				<expected>}}</expected>
				<found>(</found>
			</exception>
		</case>
	</suite>
</suites>
