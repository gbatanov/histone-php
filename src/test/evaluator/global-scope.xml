<?xml version="1.0" encoding="UTF-8"?>
<suites>

	<suite name="global for function calls">

		<!-- check if global include function works -->
		<case>
            <resourceResolver type="default"/>
            <input>a {{include(':baseURI:testresources/tpl/test_for_include.tpl')}} b</input>
			<expected>a include file contents b</expected>
		</case>

		<!-- Check global min function work properly -->
		<case>
			<input>a {{min(1,2)}} b</input>
			<expected>a 1 b</expected>
		</case>
		<case>
			<input>a {{global.max(1,2)}} b</input>
			<expected>a 2 b</expected>
		</case>

		<!-- if macro has same name as global function, then this global function should be accesible via global.functionName() -->
		<case>
			<input>a {{macro max(x,y)}}555{{/macro}} b {{global.max(1,2)}} c {{max(1,2)}} d</input>
			<expected>a  b 2 c 555 d</expected>
		</case>

		<!-- user registered global function should override predefined sponde function - moved to global-function-registration
		<case>
			<function name="max" return="number">555</function>
			<input>a {{global.max(1,2)}} b {{max(1,2)}} c</input>
			<expected>a 555 b 555 c</expected>
		</case>
-->
		<case>
			<input>a {{global.undefinedFunction().isUndefined()}} b</input>
			<expected>a true b</expected>
		</case>
	</suite>


	<suite name="global as it is">
		<case>
			<input>a {{global.isMap()}} b</input>
			<expected>a true b</expected>
		</case>
	</suite>

	<suite name="global and context">
		<case>
			<input>a {{global.isMap()}} b {{global}} c {{this['global']}} d</input>
			<context>{"global":"123"}</context>
			<expected>a true b  c 123 d</expected>
		</case>

		<case>
			<input>a {{this}} b {{global}} c</input>
			<context>"test"</context>
			<expected>a test b  c</expected>
		</case>

		<!-- check global inside for loop -->
		<case>
			<input>a {{for x in [1, 2, 3]}}{{global.isMap()}} {{/for}} b</input>
			<expected>a true true true  b</expected>
		</case>

		<!-- check global inside macro -->
		<case>
			<input>a {{macro myMacro}}{{global.isMap()}}{{/macro}} b {{myMacro()}} c</input>
			<expected>a  b true c</expected>
		</case>
	</suite>


	<suite name="global.baseURI">
		<!-- Simple case -->
		<case>
			<global name="baseURI" value="dummy:///"/>
			<input>a {{global.baseURI}} b</input>
			<expected>a dummy:/// b</expected>
		</case>

		<!-- Simple case -->
		<case>
			<global name="baseURI" value="dummy:///test/"/>
			<input>a {{global.baseURI}} b</input>
			<expected>a dummy:///test/ b</expected>
		</case>

		<!-- Simple case -->
		<case>
			<global name="baseURI" value="dummy://some/"/>
			<input>a {{global.baseURI}} b</input>
			<expected>a dummy://some/ b</expected>
		</case>

		<!-- Simple case -->
		<case>
			<global name="baseURI" value="dummy://some/test/"/>
			<input>a {{global.baseURI}} b</input>
			<expected>a dummy://some/test/ b</expected>
		</case>

		<!-- macro case -->
		<case>
			<global name="baseURI" value="dummy://some/test/"/>
			<input>a {{macro myMacro}}{{global.baseURI}}{{/macro}} b {{myMacro()}} c</input>
			<expected>a  b dummy://some/test/ c</expected>
		</case>
	</suite>

</suites>